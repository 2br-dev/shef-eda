<?php
/**
* ReadyScript (http://readyscript.ru)
*
* @copyright Copyright (c) ReadyScript lab. (http://readyscript.ru)
* @license http://readyscript.ru/licenseAgreement/
*/

namespace Antivirus\Model\Libs\Manul;


use Antivirus\Model\Utils;

class MalwareInfo
{
    const TITLE_WEB_SHELL   = "WebShell";
    const TITLE_JS_VIRUS    = "JS Virus";
    const TITLE_SUSPICIOUS  = "Suspicious Code";


    /**
     * Краткое описание уязвимости
     *
     * @var string
     */
    public $title;

    /**
     * Позиция уязвимости в файле
     *
     * @var int
     */
    public $pos;

    /**
     * Фрагмент кода, содержащий уязвимость
     *
     * @var string
     */
    public $fragment;

    /**
     * @var string
     */
    public $filename;

    /**
     * Тип сигнатруры. re - регулярное выражение, const - строка
     *
     * @var string
     */
    public $format;

    /**
     * Идентификатор сигнатуры
     *
     * @var int
     */
    public $signatureId;

    /**
     * Текст сигнатуры (регулярное выражение или строка)
     *
     * @var string
     */
    public $signature;


    /**
     * Возвращает путь к файлу относительно корня сайта
     *
     * @return string
     */
    public function getRelativeFilename()
    {
        return Utils::fullPathToRelative($this->filename);
    }
}